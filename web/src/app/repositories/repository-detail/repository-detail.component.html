
<div class="repository-detail-container">
  <!-- Loading overlay that blocks user interaction -->
  @if (isLoading) {
    <div class="loading-overlay">
      <div class="spinner-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading...</p>
      </div>
    </div>
  }

  @if (error) {
    <mat-card class="error-message">
      <mat-card-content>
        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px;">
          <mat-icon color="warn">error</mat-icon>
          <p>{{ error }}</p>
        </div>
        <button mat-button color="primary" routerLink="/home">
          <mat-icon>home</mat-icon>
          Back to Home
        </button>
      </mat-card-content>
    </mat-card>
  }

  @if (!isLoading && !error && repository) {
    <div>
      <div class="content-layout">
        <!-- Sidenav for collections -->
        <mat-card class="sidenav">
          <mat-card-header>
            <mat-card-title>Collections</mat-card-title>
          </mat-card-header>
          <mat-card-content class="sidenav-content">
            @if (collections.length === 0) {
              <div class="empty-state-sidenav">
                <mat-icon style="color: #ccc; font-size: 24px;">folder_open</mat-icon>
                <p>No collections found</p>
              </div>
            }
            <mat-nav-list class="collection-list">
              @for (collection of collections; track collection) {
                <mat-list-item
                  [activated]="collection.name === selectedColName"
                  (click)="selectCollection(collection)"
                  (mouseenter)="onCollectionHover(collection.name)"
                  (mouseleave)="onCollectionLeave()"
                  class="collection-item">
                  <mat-icon matListItemIcon>folder</mat-icon>
                  <span matListItemTitle>{{ collection.label }}</span>
                </mat-list-item>
              }
            </mat-nav-list>
          </mat-card-content>
        </mat-card>
        <!-- Main content area -->
        <div class="main-content" (scroll)="handleScroll($event)">
          <!-- Show info message if no collection is selected -->
          @if (!selectedColName) {
            <mat-card class="info-message-large">
              <mat-card-content>
                <div style="text-align: center; padding: 40px;">
                  <mat-icon style="font-size: 48px; height: 48px; width: 48px; color: #ccc;">info</mat-icon>
                  <p>Select a collection from the sidebar to browse its files.</p>
                </div>
              </mat-card-content>
            </mat-card>
          }
          <router-outlet></router-outlet>
          <!-- Back to top button -->
          @if (showBackToTop) {
            <button
              mat-fab
              color="primary"
              class="back-to-top-btn"
              (click)="scrollToTop()"
              matTooltip="Back to top">
              <mat-icon>arrow_upward</mat-icon>
            </button>
          }
          <!-- Scroll to bottom button -->
          @if (showScrolltoBottom) {
            <button
              mat-fab
              color="accent"
              class="scroll-to-bottom-btn"
              (click)="scrollToBottom()"
              matTooltip="Scroll to bottom">
              <mat-icon>arrow_downward</mat-icon>
            </button>
          }
        </div>
      </div>
    </div>
  }
</div>
